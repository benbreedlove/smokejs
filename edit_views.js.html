<!DOCTYPE html>

<html lang="en">
<head>
	<meta charset="utf-8">
	<title>Smoke Docs Source: edit_views.js</title>

	<!--[if lt IE 9]>
	<script src="//html5shiv.googlecode.com/svn/trunk/html5.js"></script>
	<![endif]-->
	<link type="text/css" rel="stylesheet" href="styles/sunlight.default.css">

	<link type="text/css" rel="stylesheet" href="styles/site.cyborg.css">

</head>

<body>
<div class="container-fluid">
	<div class="navbar navbar-fixed-top navbar-inverse">
		<div class="navbar-inner">
			<a class="brand" href="index.html">Smoke Docs</a>
			<ul class="nav">
				
				<li class="dropdown">
					<a href="modules.list.html" class="dropdown-toggle" data-toggle="dropdown">Modules<b
						class="caret"></b></a>

					<ul class="dropdown-menu ">
						
						<li>
							<a href="module-api.html">api</a>
						</li>
						
						<li>
							<a href="module-edit_api.html">edit_api</a>
						</li>
						
						<li>
							<a href="module-edit_views.html">edit_views</a>
						</li>
						
						<li>
							<a href="module-main.html">main</a>
						</li>
						
						<li>
							<a href="module-markdown.html">markdown</a>
						</li>
						
						<li>
							<a href="module-router.html">router</a>
						</li>
						
						<li>
							<a href="module-views.html">views</a>
						</li>
						

					</ul>
				</li>
				
				<li class="dropdown">
					<a href="classes.list.html" class="dropdown-toggle" data-toggle="dropdown">Classes<b
						class="caret"></b></a>

					<ul class="dropdown-menu ">
						
						<li>
							<a href="module-api.Component.html">Component</a>
						</li>
						
						<li>
							<a href="module-edit_api.Component.html">Component</a>
						</li>
						

					</ul>
				</li>
				
			</ul>
		</div>
	</div>

	<div class="row-fluid">

		
			<div class="span12">
				
				<div id="main">
					


		<h1 class="page-title">Source: edit_views.js</h1>
    
<section>
	<article>
		<pre
			class="sunlight-highlight-javascript linenums">var views = require('./views');
var $ = require('jquery');
/**
 * Include views to be called by the router here each should
 * take a callback that takes in data, html
 * and returns a promise which is resolved after its loaded.
 * @module edit_views
 */

/**
 * Main view for rendering components and making them editable.
 * @param {object} match - match object Returned by routes.
 * @param {function} callback - callback is called with html
 * @returns {promise} Resolves when complete
 */
exports.displayMainContent = function(match, callback) {
  callback = callback ? callback : function() {};
  var component;
  var cb = function(data, html) {
    component = data;
    html += exports._socialSharingElement(component);
    callback(data, html);
    exports._makeEditable(component);
  };
  return views.displayMainContent(match, cb);
};

/**
 * View for rendering the homepage and making it editable.
 * @param {object} match - match object Returned by routes.
 * @param {function} callback - callback is called with html
 * @returns {promise} Resolves when complete
 */
exports.displayHomepage = function(match, callback) {
  callback = callback ? callback : function() {};
  var homepage;
  var cb = function(data, html) {
    homepage = data;
    html += exports._socialSharingElement(component);
    callback(data, html);
    //make editable somehow
    // probably calling make editable on it? need to review the
    // splash page json
  };
  return views.displayHomepage(match, cb);
};

/**
 * helper function. If a single component, makes it's metadata, attributes
 * and main data editable. If an array (a list) makes the array sortable
 * adds a save buttton to the component
 * @param {component} component - The component we're making editable
 * @returns {void}
 */
exports._makeEditable = function(component) {
  if (Object.prototype.toString.call( component ) === '[object Array]') {
    exports._makeListEditable(component);
  } else {
    for (var meta in component.metadata) {
      exports._editableMetadata(component, meta);
    }
    for (var attr in component.attributes) {
      exports._makeEditable(component.attributes[attr]);
    }
    exports._editableData(component);
  }
  $('#' + component.slug).append(exports._createSaveButton(component));
};

/**
 * helper function. Makes an array sortable
 * @param {array} components - The component array we're making sortable
 * @returns {void}
 */
exports._makeListEditable = function(components) {
  console.log(components);
  // uhhh. welp
};

/**
 * helper function. Makes data editable
 * @param {component} component - The component who's data we're making editable
 * @returns {void}
 */
exports._editableData = function(component) {
  console.log(component);
  // uhhh. welp
};

/**
 * helper function. Makes a metadata html element editable, and makes
 * changes on the component object when the content changes.
 * @param {component} component - The component who's metadata we're making editable
 * @param {string} meta - The name of the metadata we're making editable
 * @returns {void}
 */
exports._editableMetadata = function(component, meta) {
  $('.' + component.slug + '.' + meta)
    .attr('contentEditable', true)
    .on('blur', function() {
      component.metadata[meta] = $(this).text();
      console.log('updated metadata', component.metadata[meta]);
    });
};

/**
 * helper function. creates a panel from which editors can change component
 * metadata related to social sharing
 * @param {component} component - The component who's social data we're editing
 * @param {string} meta - The name of the metadata we're making editable
 * @returns {string} html - the raw html of the social sharing element
 */
exports._socialSharingElement = function(component) {
  return "&lt;div>&lt;h4>this could one day be an edit popup or something" + component.slug + "&lt;/h4>&lt;/div>";
};

/**
 * helper function. creates the button that updates a component on click
 * @param {component} component - The component that will be updated
 * @returns {element} button - the jQuery element that will update a component on click
 */
exports._createSaveButton = function(component) {
  return $('&lt;button>Save&lt;/button>')
    .click(function() {
      component.update().then(
        exports._successNotice,
        exports._failureNotice
      );
    }
  );
};

/**
 * helper function. Runs when a component is successfully updated
 * eventually we want this to put up a banner saying 'saved' that fades out
 * @param {string} message - The success message
 */
exports._successNotice = function(message) {
  console.log('updated successfully', message);
};

/**
 * helper function. Runs when a component fails to update
 * eventually we want this to put up a banner saying 'failed' that fades out
 * we should consider replacing this w/ the EnvConfig error handling
 * @param {string} message - The success message
 */
exports._successNotice = function(error) {
  console.log('updating failed!', error);
};
</pre>
	</article>
</section>





				</div>

				<div class="clearfix"></div>
				<footer>
					
					
		<span class="copyright">
		MotherJones Copyright Â© 2012-2014
		</span>
					<br />
					
		<span class="jsdoc-message">
		Documentation generated by <a href="https://github.com/jsdoc3/jsdoc">JSDoc 3.2.2</a>
		on Thu Jul 10th 2014 using the <a
			href="https://github.com/terryweiss/docstrap">DocStrap template</a>.
		</span>
				</footer>
			</div>

			
			<br clear="both">
		</div>

	</div>
	<!--<script src="scripts/sunlight.js"></script>-->
	<script src="scripts/docstrap.lib.js"></script>
	<script src="scripts/bootstrap-dropdown.js"></script>
	<script src="scripts/toc.js"></script>

	<script>
		$( function () {
			$( "#toc" ).toc( {
				anchorName  : function ( i, heading, prefix ) {
					return $( heading ).attr( "id" ) || ( prefix + i );
				},
				selectors   : "h1,h2,h3,h4",
				showAndHide : false,
				scrollTo    : 60
			} );
			$( "#toc>ul" ).addClass( "nav nav-pills nav-stacked" );
			$( "#main span[id^='toc']" ).addClass( "toc-shim" );
			$('.dropdown-toggle').dropdown();
//			$( ".tutorial-section pre, .readme-section pre" ).addClass( "sunlight-highlight-javascript" ).addClass( "linenums" );

			$( ".tutorial-section pre, .readme-section pre" ).each( function () {
				var $this = $( this );

				var example = $this.find("code" );
				exampleText = example.html();
				var lang = /{@lang (.*?)}/.exec( exampleText );
				if ( lang && lang[1] ) {
					exampleText = exampleText.replace( lang[0], "" );
					example.html(exampleText);
					lang = lang[1];
				} else {
					lang = "javascript";
				}

				if ( lang ) {

					$this
						.addClass( "sunlight-highlight-" + lang )
						.addClass( "linenums" )
						.html( example.html() );

				}
			} );

			Sunlight.highlightAll( {
				lineNumbers : true,
				showMenu:true,
				enableDoclinks:true
		} );
		} );

	</script>

	<!--Google Analytics-->
	

	<!--Navigation and Symbol Display-->
	

</body>
</html>
